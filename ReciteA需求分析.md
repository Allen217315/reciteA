# 背诵复习助手网站需求分析文档

## 1. 项目概述
开发一款背诵复习助手网站，支持用户上传学习资料，生成复习卡片组，并通过多种复习模式优化记忆效果，同时提供错题本动态管理及数据统计功能。

---

## 2. 需求概述
### 2.1 核心功能模块
1. 数据导入与管理
2. 学习资料管理
3. 卡片组管理
4. 复习卡片生成
5. 学习与复习模式
6. 数据统计与反馈
7. 系统与技术支持

---

## 3. 功能需求
### 3.1 主页面设计
左侧为导航栏，右侧为内容区。
导航栏包含：
- 首页
- 学习资料  
- 卡片组
- 复习卡片
- 数据统计


### 3.2 数据导入与管理
#### 功能描述
用户可以通过上传 Excel 文件，将学习资料导入系统进行管理。

#### 功能清单
- **上传文件**：
  - 支持上传 `.xlsx` 格式的文件。
  - 文件格式要求：
    - 必须包含以下字段：
      - **知识内容**：需要导入的学习内容（必填）。
      - **分类标签**：学习内容所属分类（可选）。
    - 示例格式：
      \`\`\`plaintext
      | 知识内容                | 分类标签 |
      |-------------------------|----------|
      | 床前明月光，疑是地上霜。| 唐诗     |
      | 举头望明月，低头思故乡。| 唐诗     |
      | 关关雎鸠，在河之洲。    | 诗经     |
      \`\`\`

- **数据解析**：
  - 上传文件时，系统对文件内容进行解析。
  - 根据文件中的 **分类标签** 字段，自动生成学习资料类别名称。
  - 如果分类标签为空，则将该条目归入"未分类"类别。

---

### 3.2 学习资料管理
#### 功能描述
用户可以对学习资料的知识条目进行查看、编辑、删除等操作。

#### 功能清单
- **查看与筛选**：
  - 点击学习资料类别名称，显示该类别下的知识条目。
  - 支持按分类标签、关键字搜索知识条目。

- **批量管理**：
  - 支持对知识条目进行批量操作，包括：
    - 删除：一次删除多个知识条目。
    - 分类调整：修改多个知识条目的分类标签。
    - 编辑：批量修改知识内容或标签。


#### 界面设计
- **页面标题**：
  - 页面顶部显示“学习资料”标题，字体加粗，居中对齐。

- **文件上传区域**：
  - **上传文件按钮**：
    - 一个明显的按钮，标记为“上传学习资料”。
  - **文件格式提示**：
    - 在上传按钮下方，提供文件格式要求的提示信息，例如：“支持上传 .xlsx 格式的文件，必须包含知识内容和分类标签字段。”
  - **进度条**：
    - 上传文件时显示进度条，告知用户上传状态。
  - **成功/失败提示**：
    - 上传完成后，显示成功或失败的提示信息。

- **学习资料条目管理**：
  - **搜索框**：
    - 页面顶部提供一个搜索框，用户可以按分类标签或关键字搜索学习资料条目。
  - **学习资料列表**：
    - 显示学习资料条目的表格，包含以下列：
      - **全选复选框**：在表格的表头添加一个复选框，用户可以通过勾选该框来全选或取消全选所有条目。
      - 知识内容
      - 分类标签
      - 操作（编辑、删除按钮）
  - **编辑按钮**：
    - 每个条目旁边有一个“编辑”按钮，点击后弹出编辑框，允许用户修改知识内容和分类标签。
  - **删除按钮**：
    - 每个条目旁边有一个“删除”按钮，点击后弹出确认对话框，确认后删除该条目。

- **批量操作功能**：
  - **批量选择框**：
    - 在学习资料列表的每一行前面添加复选框，用户可以选择多个条目进行批量操作。
  - **批量删除按钮**：
    - 在列表上方或下方提供一个“批量删除”按钮，点击后弹出确认对话框，确认后删除选中的条目。
  - **分类调整按钮**：
    - 提供一个“批量调整分类”按钮，点击后弹出选择框，允许用户选择新的分类标签并应用于选中的条目。

---

### 3.3 卡片组管理
#### 功能描述
用户可对卡片组及其内容进行管理操作。

#### 功能清单
- **卡片组管理**：
  - 新增卡片组：用户可以创建新的卡片组。
  - 修改卡片组：用户可以更改卡片组名称或描述。
  - 删除卡片组：用户可以删除不需要的卡片组。
  - 查询卡片组：用户可以查看现有卡片组及其内容。

- **卡片管理**：
  - 新增卡片：用户可以向卡片组内新增卡片。
  - 修改卡片：用户可以编辑卡片内容（正反面）。
  - 删除卡片：用户可以删除特定卡片。
  - 批量操作：支持批量新增、修改、删除卡片。

- **错题本管理**：
  - 新增错题本：系统根据复习结果自动生成错题本。
  - 删除错题本卡片：仅将卡片移出错题本，不删除卡片组内的内容。


---

### 3.4 复习卡片生成
#### 功能描述
用户可以选择学习资料生成复习卡片组。

#### 功能清单
- **操作流程**：
  1. 点击“生成复习卡片”按钮，弹出卡片生成参数选择框。
  2. 用户选择卡片生成模式：
     - **基础卡片模式**：
       - 正面显示段落的前半部分，后面添加下划线“_______________”。
       - 背面显示下划线“_______________”，后面加段落的后半部分。
     - **填空模式**：
       - 暂时不实现具体功能。
  3. 选择生成资料：
     - 下拉菜单，用户可以选择要生成复习卡片的学习资料分类标签。
  4. 选择生成方式：
     - **生成新的卡片组**：填写新的卡片组名称，点击确认后生成新的卡片组，并将生成的复习卡片放置于该卡片组内。
     - **加入已有卡片组**：选择已有的卡片组名称，点击确认后，将生成的复习卡片加入该卡片组。

---
#### 界面设计
- **页面标题**：
  - 页面顶部显示“卡片组管理”标题，字体加粗，居中对齐。

- **卡片组列表**：
  - 显示已存在的卡片组，列表中包含以下信息：
    - **卡片组名称**：每个卡片组的名称。
    - **卡片数量**：显示每个卡片组中包含的卡片数量。
    - **操作按钮**：
      - **查看按钮**：点击后进入该卡片组的管理页面。
      - **删除按钮**：点击后弹出确认对话框，确认后删除该卡片组。
      - **开始复习**：点击后进入该卡片组的复习页面。

- **生成复习卡片按钮**：
  - 在页面的显眼位置（如页面顶部或卡片组列表下方）设置一个“生成复习卡片”按钮。

- **生成复习卡片弹窗**：
  - 点击“生成复习卡片”按钮后，弹出一个对话框，包含以下选项：
    - **生成模式选择**：
      - 单选框，用户可以选择“基础卡片模式”或“填空模式”。
    - **生成方式选择**：
      - 单选框，用户可以选择“创建新的卡片组”或“加入已有卡片组”。
      - 如果选择“加入已有卡片组”，则需要提供一个下拉菜单，列出所有已存在的卡片组供用户选择。
    - **生成资料选择**：
      - 下拉菜单，用户可以选择要生成复习卡片的学习资料分类标签。
    - **确认按钮**：
      - “确认生成”按钮，用户点击后根据选择的模式和方式生成复习卡片，并跳转到生成的卡片组内卡片列表管理页面。

- **卡片组内卡片管理页面**：
  - 当用户点击某个卡片组的“查看”按钮时，进入该卡片组的管理页面，显示该卡片组中所有卡片的信息，以列表形式呈现，包含以下信息：
    - **卡片内容**：显示每个卡片的内容。
    - **操作列**：
      - **编辑按钮**：每个卡片旁边有一个“编辑”按钮，点击后弹出编辑框，允许用户修改卡片内容。
      - **删除按钮**：每个卡片旁边有一个“删除”按钮，点击后弹出确认对话框，确认后删除该卡片。
      - **批量操作**：
        - **批量选择框**：在表格的表头添加一个复选框，用户可以通过勾选该框来全选或取消全选所有条目。
        - **批量删除按钮**：在列表上方或下方提供一个“批量删除”按钮，点击后弹出确认对话框，确认后删除选中的卡片。
        - **批量编辑按钮**：在列表上方或下方提供一个“批量编辑”按钮，点击后弹出编辑框，允许用户修改选中的卡片内容。


### 3.5 学习与复习模式
#### 功能描述
支持多种复习模式，优化用户记忆效果。

#### 功能清单
- **复习模式选择**：
  - **基本复习模式**：
    - 设置全面复习或仅复习错题本。
    - 全面复习：
      - 系统随机优先显示答对次数最少的卡片，答对次数相同则随机显示。
      - 记录复习次数和结果次数（记住/未记住）。
      - 未记住的卡片加入错题本。
    - 仅复习错题本：
      - 系统随机优先显示答错次数最多的卡片，答错次数相同则随机显示。
      - 连续答对三次的卡片从错题本中移除。
    

#### 界面设计
- **页面标题**：
  - 页面顶部显示“卡片复习”标题，字体加粗，居中对齐。
- **复习卡片组选择**：
  - 下拉菜单，用户可以选择要复习的卡片组。
- **复习模式选择**：
  - 页面上方提供复习模式选择，用户可以选择：
    - **全面复习**：复习所有卡片。
    - **仅复习错题本**：仅复习之前标记为错误的卡片。
  - 使用单选框，用户可以选择其中一个模式。

- **卡片显示区域**：
  - 显示当前复习的卡片内容，包含以下信息：
    - **卡片内容**：
      - 若生成的卡片模式为“基础卡片模式”，则随机显示卡片的正面或背面内容。
      - 若生成的卡片模式为“填空模式”，则显示填空题。
    - **显示答案按钮**：一个按钮，标记为“显示答案”，用户点击后显示关联的学习资料全文（例如答案或解释）。

- **操作按钮**：
  - **正确/错误按钮**：
    - 在卡片显示区域下方，提供两个按钮，标记为“正确”和“错误”。用户可以根据自己的复习情况选择相应的按钮。
  - **下一张卡片按钮**：
    - 在“正确”和“错误”按钮旁边，提供一个“下一张卡片”按钮，用户点击后加载下一张卡片。

- **复习进度指示**：
  - 页面底部显示复习进度，例如“已复习 1/10 张卡片”，以便用户了解当前的复习进度。

- **结束复习按钮**：
  - 在页面的显眼位置（如右上角）设置一个“结束复习”按钮，用户点击后可以结束当前的复习会话。

---

### 3.6 数据统计与反馈
#### 功能描述
为用户提供学习进度和效果的可视化反馈。

#### 功能清单
- **复习统计**：
  - 显示卡片复习次数和熟练度。
  - 统计错题次数和正确率。

- **学习报告**：
  - 生成复习报告，支持导出为 Excel 或 PDF。

---

### 3.7 系统与技术支持
#### 功能描述
确保系统稳定运行并支持多端访问。

#### 功能清单
- **多端兼容**：
  - 支持 PC 和移动端访问，响应式设计。
- **文件导入导出**：
  - 支持学习资料的批量导入与复习数据导出。
- **AI 辅助功能**：
  - 自动识别关键词生成填空题。
  - 根据用户记忆反馈动态调整复习内容。

---

## 4. 非功能性需求
1. **性能要求**：
   - 系统响应时间不超过 1 秒。
   - 支持少量同时在线用户，不超过 10 个。

---

## 5. 开发计划
1. **需求确认阶段**（1 周）
2. **原型设计阶段**（2 周）
3. **开发与测试阶段**（6 周）
4. **上线准备与部署阶段**（2 周）

---

## 6. 风险与解决方案
- **需求变更风险**：
  - 与用户保持密切沟通，采用敏捷开发模式。
- **技术难点**：
  - AI 填空题生成：优先实现简单逻辑，逐步优化算法。
- **性能问题**：
  - 系统初期部署单节点服务，确保支持少量用户，后续根据需求扩展。

## 7. 用户系统需求

### 7.1 用户账户管理
#### 功能描述
提供用户注册、登录和个人信息管理功能。

#### 功能清单
- **用户注册**：
  - 注册信息要求：
    - 用户名（必填）：4-16位字符，只能包含字母、数字和下划线
    - 密码（必填）：8-20位，必须包含字母和数字
  - 注册限制：
    - 用户名不可重复
    - 同一IP地址每天最多注册3个账号

- **用户登录**：
  - 登录方式：
    - 用户名+密码登录
  - 登录安全措施：
    - 密码错误3次后需要输入验证码
    - 支持"记住我"功能（7天内自动登录）

### 7.2 用户角色权限

### 7.3 个人信息管理
#### 功能描述
用户可以管理和更新个人信息。

#### 功能清单
- **基础信息管理**：
  - 修改个人信息：
    - 头像上传（支持jpg/png格式，大小限制2MB）
    - 昵称修改
    - 个人简介
  - 修改密码：
    - 需要输入原密码
    - 新密码不能与当前密码相同

## 8. 技术栈方案

### 8.1 开发环境
- Node.js 18+ (LTS版本)
- VS Code (推荐IDE)
- Git 版本控制
- Docker (可选，用于本地数据库)

### 8.2 前端技术
- **核心框架**：
  - Next.js 14 (React框架)
    - 支持SSR/SSG
    - 内置API Routes
    - 开发体验好
    - Vercel平台原生支持

- **UI框架**：
  - Tailwind CSS
  - shadcn/ui组件库
    - 高度可定制
    - 现代化设计
    - 开发效率高

### 8.3 后端技术
- **服务端**：
  - Next.js API Routes
    - 与前端使用同一框架
    - 适合快速开发
    - 易于部署

- **数据库**：
  - MongoDB Atlas (主数据库)
    - 提供免费套餐
    - 适合存储卡片等数据
    - 易于扩展
  - Vercel KV (缓存层)
    - 基于Redis
    - 用于存储会话信息
    - 与Vercel平台集成

- **认证方案**：
  - NextAuth.js
    - 完整的认证解决方案
    - 与Next.js无缝集成

### 8.4 部署方案
- **部署平台**：
  - Vercel
    - 提供免费套餐
    - 自动化部署
    - 全球CDN加速
    - 开发体验好

## 9. 开发步骤规划

### 9.1 最小可用模型（MVP）
实现一个最基础的背诵功能，用户可以创建简单的卡片并进行复习。

#### 9.1.1 阶段 0：项目初始化
1. 创建 Next.js 项目
   - 使用 create-next-app 创建项目
   - 配置 TypeScript
   - 配置 ESLint 和 Prettier

2. 配置基础开发环境
   - 安装并配置 Tailwind CSS
   - 安装 shadcn/ui 组件库
   - 创建基础目录结构

3. 设置数据库
   - 创建 MongoDB Atlas 账号(用户：allen100401密码:cxbdsjed)
   - 设置数据库连接
   - 实现 `lib/db.ts` 连接工具

4. 创建核心组件
   - 实现 `components/ui/` 基础组件
   - 创建 `app/layout.tsx` 根布局
   - 创建 `components/layout/` 布局组件

#### 9.1.2 阶段 1：基础卡片功能
1. 实现卡片数据模型
   - 创建 `models/Card.ts`
   - 定义卡片 Schema
   - 实现基础 CRUD 方法

2. 开发卡片 API
   - 实现 `app/api/cards/route.ts`
   - 实现创建卡片 API
   - 实现获取卡片列表 API
   - 实现更新和删除 API

3. 实现卡片界面
   - 创建 `components/cards/CardForm.tsx`
   - 创建 `components/cards/CardList.tsx`
   - 实现 `app/cards/create/page.tsx`
   - 实现 `app/cards/page.tsx`

4. 实现基础复习功能
   - 创建 `components/study/StudyCard.tsx`
   - 实现 `app/study/page.tsx`
   - 添加简单的记忆标记功能

### 9.2 功能迭代计划

#### 9.2.1 阶段 2：用户系统
1. 设置认证框架
   - 配置 NextAuth.js
   - 创建 `models/User.ts`
   - 实现 `lib/auth.ts`

2. 实现认证界面
   - 创建登录注册表单组件
   - 实现登录注册页面
   - 添加认证中间件

3. 数据关联
   - 更新卡片模型，添加用户关联
   - 修改现有 API，添加用户验证
   - 更新前端组件，适配用户系统

#### 9.2.2 阶段 3：卡片组管理
1. 基础卡片组功能
   - 创建 `models/Deck.ts`
   - 实现卡片组 API
   - 创建卡片组界面组件

2. 卡片关联
   - 更新卡片模型，添加卡片组关联
   - 实现卡片分组功能
   - 添加批量操作功能

#### 9.2.3 阶段 4：数据导入导出
1. 添加文件处理
   - 创建 `components/import/` 目录
   - 实现文件上传组件
   - 添加 Excel 解析功能

2. 数据处理
   - 实现数据验证
   - 添加批量导入功能
   - 实现错误处理

#### 9.2.4 阶段 5：学习功能增强
1. 复习算法
   - 更新 `models/Study.ts`
   - 实现间隔复习逻辑
   - 添加学习进度追踪

2. 错题本功能
   - 创建错题本相关组件
   - 实现错题收集逻辑
   - 添加错题复习模式

#### 9.2.5 阶段 6：数据统计
1. 统计功能
   - 创建 `components/stats/` 目录
   - 实现数据统计逻辑
   - 添加图表组件

2. 学习报告
   - 实现学习数据汇总
   - 创建报告生成功能
   - 添加数据导出功能

#### 9.2.6 阶段 7：系统优化
1. 性能优化
   - 添加数据缓存
   - 优化数据库查询
   - 实现分页加载

2. 用户体验
   - 添加加载状态
   - 优化错误提示
   - 完善响应式布局

### 9.3 测试计划
每个功能模块完成后：
1. 单元测试：测试新增功能的核心逻辑
2. 集成测试：测试与现有功能的交互
3. 用户界面测试：测试用户操作流程
4. 性能测试：测试系统响应时间和并发处理能力

### 9.4 部署计划
1. 配置 Vercel 部署环境
2. 设置环境变量
3. 配置域名和 SSL 证书
4. 设置监控和日志系统

### 9.5 开发注意事项
1. 每个阶段的功能应该是独立可用的
2. 保持代码简洁，避免过度设计
3. 及时进行代码审查和重构
4. 保持良好的代码注释和文档更新

## 10. 项目文件结构

### 10.1 目录结构
src/
├── app/ # Next.js 13+ App Router 目录
│ ├── (auth)/ # 认证相关路由组
│ │ ├── login/
│ │ │ └── page.tsx # 登录页面
│ │ ├── register/
│ │ │ └── page.tsx # 注册页面
│ │ └── layout.tsx # 认证页面布局
│ │
│ ├── (dashboard)/ # 主应用路由组
│ │ ├── cards/
│ │ │ ├── [id]/ # 动态路由：单个卡片
│ │ │ │ └── page.tsx # 卡片详情页
│ │ │ ├── create/
│ │ │ │ └── page.tsx # 创建卡片页
│ │ │ └── page.tsx # 卡片列表页
│ │ │
│ │ ├── decks/ # 卡片组相关页面
│ │ │ ├── [id]/
│ │ │ │ └── page.tsx # 卡片组详情页
│ │ │ ├── create/
│ │ │ │ └── page.tsx # 创建卡片组页
│ │ │ └── page.tsx # 卡片组列表页
│ │ │
│ │ ├── study/
│ │ │ ├── [deckId]/ # 学习特定卡片组
│ │ │ │ └── page.tsx # 学习页面
│ │ │ └── page.tsx # 学习首页
│ │ │
│ │ ├── profile/ # 用户资料
│ │ │ └── page.tsx # 个人信息页
│ │ │
│ │ ├── stats/
│ │ │ └── page.tsx # 学习统计页
│ │ │
│ │ └── layout.tsx # 主应用布局
│ │
│ ├── api/ # API 路由
│ │ ├── auth/ # 认证相关 API
│ │ │ └── [...nextauth]/
│ │ │ └── route.ts # NextAuth 配置
│ │ │
│ │ ├── cards/ # 卡片相关 API
│ │ │ ├── route.ts # 卡片 CRUD
│ │ │ └── [id]/
│ │ │ └── route.ts # 单个卡片操作
│ │ │
│ │ ├── decks/ # 卡片组相关 API
│ │ │ ├── route.ts # 卡片组 CRUD
│ │ │ └── [id]/
│ │ │ └── route.ts # 单个卡片组操作
│ │ │
│ │ └── import/ # 数据导入 API
│ │ └── route.ts # Excel 导入处理
│ │
│ ├── layout.tsx # 根布局
│ └── page.tsx # 首页
│
├── components/ # 组件目录
│ ├── auth/ # 认证相关组件
│ │ ├── LoginForm.tsx
│ │ └── RegisterForm.tsx
│ │
│ ├── cards/ # 卡片相关组件
│ │ ├── CardForm.tsx # 卡片编辑表单
│ │ ├── CardItem.tsx # 卡片列表项
│ │ └── CardList.tsx # 卡片列表
│ │
│ ├── decks/ # 卡片组相关组件
│ │ ├── DeckForm.tsx
│ │ ├── DeckItem.tsx
│ │ └── DeckList.tsx
│ │
│ ├── study/ # 学习相关组件
│ │ ├── StudyCard.tsx # 学习卡片展示
│ │ └── Progress.tsx # 进度展示
│ │
│ ├── ui/ # 通用 UI 组件
│ │ ├── Button.tsx
│ │ ├── Input.tsx
│ │ └── Modal.tsx
│ │
│ ├── layout/ # 布局组件
│ │ ├── Header.tsx
│ │ ├── Sidebar.tsx
│ │ └── Footer.tsx
│ │
│ ├── import/              # 数据导入相关组件
│ │   ├── ImportForm.tsx   # 导入表单
│ │   └── ImportPreview.tsx # 导入预览
│ │
│ └── stats/              # 统计相关组件
│       ├── Charts.tsx      # 统计图表
│       └── Summary.tsx     # 统计摘要
│
├── lib/ # 工具库
│ ├── auth.ts # 认证相关工具
│ ├── db.ts # 数据库连接
│ └── utils/ # 通用工具
│ ├── api.ts # API 请求工具
│ └── validation.ts # 表单验证
│
├── models/ # 数据模型
│ ├── Card.ts # 卡片模型
│ ├── Deck.ts # 卡片组模型
│ ├── User.ts # 用户模型
│ └── Study.ts # 学习记录模型
│
├── hooks/ # 自定义 Hooks
│ ├── useAuth.ts # 认证相关
│ ├── useCards.ts # 卡片操作
│ └── useStudy.ts # 学习相关
│
├── styles/ # 样式文件
│ └── globals.css # 全局样式
│
└── types/ # 类型定义
└── index.ts # 全局类型定义

### 10.2 核心文件说明

#### 10.2.1 最小可用模型（MVP）所需的核心文件
1. **基础框架文件**
   - `app/layout.tsx`: 根布局
   - `app/page.tsx`: 首页
   - `styles/globals.css`: 全局样式

2. **卡片功能相关**
   - `app/cards/page.tsx`: 卡片列表页
   - `app/cards/create/page.tsx`: 创建卡片页
   - `components/cards/`: 卡片相关组件
   - `models/Card.ts`: 卡片数据模型

3. **API 相关**
   - `app/api/cards/route.ts`: 卡片 CRUD API
   - `lib/db.ts`: 数据库连接工具

#### 10.2.2 预置的扩展文件
这些文件在 MVP 阶段可以为空，但需要预先创建以便后续开发：

1. **认证系统**
   - `app/(auth)/`: 认证相关页面
   - `app/api/auth/`: 认证 API
   - `models/User.ts`: 用户模型

2. **卡片组功能**
   - `app/decks/`: 卡片组相关页面
   - `app/api/decks/`: 卡片组 API
   - `models/Deck.ts`: 卡片组模型

3. **学习功能**
   - `app/study/`: 学习相关页面
   - `components/study/`: 学习相关组件
   - `models/Study.ts`: 学习记录模型

4. **工具和类型**
   - `lib/utils/`: 通用工具函数
   - `types/`: 类型定义
   - `hooks/`: 自定义 Hooks

### 10.3 文件结构特点
1. 采用 Next.js 13+ App Router 结构
2. 按功能模块划分目录
3. 组件和页面分离
4. 预留扩展空间
5. 类型安全

### 10.4 文件组织建议
1. 先实现 MVP 核心文件
2. 其他文件可以先创建空文件
3. 随功能迭代逐步完善
4. 保持良好的文件组织和命名


